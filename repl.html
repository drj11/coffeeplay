<html>
<body>
<style type="text/css">
.source {
  background-color: #ccc
}
</style>
<div id="repl_div">
<textarea id="repl" rows="10" spellcheck="false"
  autofocus="autofocus"></textarea>
</div>
<script type="text/coffeescript">
console.log "CoffeeScript rules!"
compileAndGo = ->
  source = $('#repl').val()
  console.log "will compile", source
  compiled = CoffeeScript.compile source, bare: yes
  console.log "compiled code", compiled
  result = {}
  try
    result.normal = eval compiled
  catch error
    result.error = error
  appendEvaluation source, result
  $('#repl').select()
appendEvaluation = (source, result) ->
  $('#repl').before($('<p>').text(source).addClass('source'))
  appendResult result
appendResult = (result) ->
  if result.normal?
    t = result.normal
    c = 'normal'
  else if result.error?
    t = result.error
    c = 'error'
  t ?= result
  $('#repl').before($('<p>').text(t).addClass(c))
$(document.body)
  .keydown (e) ->
    if e.which == 13
      compileAndGo()
      e.preventDefault()
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://coffeescript.org/extras/coffee-script.js"></script>
</html>
